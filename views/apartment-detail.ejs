<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Apartment Details</title>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
</head>

<body>
	<main class="container">
		<h1>Apartment Details</h1>
		<h2>
			<%= apartment.title %>
		</h2>

		<p><strong>Description:</strong>
			<%= apartment.description %>
		</p>
		<p><strong>Rules:</strong>
			<%= apartment.rules %>
		</p>
		<p><strong>Rooms:</strong>
			<%= apartment.rooms %>
		</p>
		<p><strong>Beds:</strong>
			<%= apartment.beds %>
		</p>
		<p><strong>Bathrooms:</strong>
			<%= apartment.bathrooms %>
		</p>
		<p><strong>Price per night:</strong> $<%= apartment.price %>
		</p>
		<p><strong>Size:</strong>
			<%= apartment.size %> sqm
		</p>
		<p><strong>Max Persons:</strong>
			<%= apartment.maxPersons %>
		</p>
		<p><strong>Province:</strong>
			<%= apartment.province %>
		</p>
		<p><strong>City:</strong>
			<%= apartment.city %>
		</p>
		<p><strong>GPS Coordinates:</strong>
			<%= apartment.gps %>
		</p>

		<% if (apartment.mainPhoto) { %>
			<img src="<%= apartment.mainPhoto %>" alt="<%= apartment.title %> photo" width="400">
			<% } %>

				<h3>Amenities:</h3>
				<ul>
					<% if (apartment.services.wifi) { %>
						<li>WiFi</li>
						<% } %>
							<% if (apartment.services.airConditioner) { %>
								<li>Air Conditioner</li>
								<% } %>
									<% if (apartment.services.kitchen) { %>
										<li>Kitchen</li>
										<% } %>
											<% if (apartment.services.disability) { %>
												<li>Disability Access</li>
												<% } %>
													<% if (apartment.services.heater) { %>
														<li>Heater</li>
														<% } %>
															<% if (apartment.services.tv) { %>
																<li>TV</li>
																<% } %>
				</ul>

				<% if (apartment.photos && apartment.photos.length> 0) { %>
					<h3>Photos:</h3>
					<ul>
						<% apartment.photos.forEach(photo=> { %>
							<li>
								<img src="<%= photo %>" alt="Apartment photo" width="200">
							</li>
							<% }) %>
					</ul>
					<% } %>

						<h3>Available Dates:</h3>
						<% if (apartment.availableDates && apartment.availableDates.length> 0) { %>
							<ul>
								<% apartment.availableDates.forEach(dateRange=> { %>
									<li>
										<%= new Date(dateRange.startDate).toLocaleDateString() %> -
											<%= new Date(dateRange.endDate).toLocaleDateString() %>
									</li>
									<% }) %>
							</ul>
							<% } else { %>
								<p>No available dates listed</p>
								<% } %>

									<h3>Book this Apartment:</h3>
									<form action="/apartment/new-reservation" method="POST">
										<input type="hidden" name="apartmentId" value="<%= apartment._id %>">
										<label for="startDate">Start Date:</label>
										<input type="date" id="startDate" name="startDate" required>

										<label for="endDate">End Date:</label>
										<input type="date" id="endDate" name="endDate" required>

										<button type="submit">Reserve</button>
									</form>

									<% if (isAdmin) { %>
										<div class="actions">
											<form action="/admin/apartment/<%= apartment._id %>/edit" method="GET"
												style="display:inline;">
												<button type="submit">Edit</button>
											</form>
											<form action="/admin/apartment/<%= apartment._id %>" method="POST"
												style="display:inline;">
												<button type="submit">Delete</button>
											</form>
										</div>
										<% } %>
	</main>
</body>

</html>